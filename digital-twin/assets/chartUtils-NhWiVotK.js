import{o as S,l as q}from"./ResponsiveTheme-CSqMbI4q.js";import{l as N,ii as J,ij as D,ik as W,dm as P,d9 as G,gy as v,Z as K,il as Q,im as _,eb as R,io as ee,ip as te,iq as ie,ir as ne,is as oe}from"./index-BR4NftXd.js";import{W as ae,B as se}from"./chartUtilsAm5-rdB4jQrY.js";import{n as le,g as X,b as re,x as de,l as ce,f as ue}from"./LineSeries-C2vuVDde.js";import{f as p,a3 as b,r as fe,G as pe}from"./Theme-CuqJ08el.js";import{u as O}from"./Tooltip-C55VcysM.js";import"./DefaultTheme-ro2-8_6j.js";import"./ColorSet-Cyxf_h1m.js";import"./Tick-BS6ycgfk.js";import"./Button-DuuouuwY.js";function xe(e,n,i=10){const t=z(n-e,!1);if(t===0)return[e,n];const o=z(t/(i-1),!0);return[Math.floor(e/o)*o,Math.ceil(n/o)*o]}function z(e,n){const i=Math.floor(Math.log10(e)),t=e/10**i;let o;return o=n?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,o*10**i}const A="#f8f8f8",E="#a9a9a9",g="#323232",me="line",ge="fill",h=15,m=12,Y=.001,he=.1,Ae=.02,I={fontFamily:"Avenir Next",paddingBottom:m/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:E,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(m/4),axisTooltipPaddingBottom:Math.round(m/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(m/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:m/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},ve={...I,axisGridStroke:g,axisLabelsColor:E,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Ze(e){const n=await ae(e.container);N(e.abortOptions);const i=J(),t=i?ve:I;n.setThemes(i?[S.new(n),q.new(n)]:[S.new(n)]);const o=D(e.container),a=n.container.children.push(le.new(n,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:o?t.paddingRight:t.paddingLeft,paddingRight:o?t.paddingLeft:t.paddingRight,maxTooltipDistance:0}));a.zoomOutButton.set("forceHidden",!0);const s=a.xAxes.push(X.new(n,{renderer:re.new(n,{})})),l=a.yAxes.push(X.new(n,{renderer:de.new(n,{})})),c=P(null),r=P("loading"),d={params:e,chart:a,xAxis:s,yAxis:l,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,get state(){return r.value},get data(){return c.value},set data(u){c.value=u}};ye(d),Te(d),be(d);const f=W([ke(d,e.onRangeChange),Ce(d,e.onCursorPositionChange),L(n.events.once("frameended",()=>{r.value="ready"})),L(n)]);return{destroy:()=>{f.remove(),r.value="destroyed"},update:u=>{u.data===d.data&&u.messages===d.messages||M(d)||Le(d,u)},zoomOut:()=>V(d)}}function M(e){return e.state==="destroyed"}function be({chart:e,xAxis:n,yAxis:i}){const t=ce.new(e.root,{behavior:"none",xAxis:n,yAxis:i});t.lineY.set("visible",!1),e.set("cursor",t)}function ye(e){var s;const{chart:n,xAxis:i,theme:t}=e;i.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(e,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),i.axisHeader.set("forceHidden",!0);const o=i.get("renderer");o.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),o.labels.template.setAll({centerX:b,centerY:b,fill:p(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const a=i.set("tooltip",O.new(n.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(s=a.get("background"))==null||s.setAll({fill:p(t.axisTooltipBackgroundColor),stroke:void 0}),a.label.setAll({fill:p(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop}),o.grid.template.setAll({strokeOpacity:1,stroke:p(t.axisGridStroke)})}function Te(e){const{yAxis:n,theme:i}=e;n.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(e,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),n.axisHeader.set("visible",!1);const t=D(e.params.container),o=n.get("renderer");o.setAll({minGridDistance:i.yAxisMinGridDistance,opposite:t,inside:!0}),o.labels.template.setAll({centerX:b,centerY:fe,fill:p(i.axisLabelsColor),fontFamily:i.fontFamily,fontSize:i.axisLabelsFontSize,fontWeight:i.axisLabelsFontWeight,maxPosition:i.yAxisMaxLabelPosition,minPosition:i.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:i.yAxisLabelSpacing,paddingRight:t?i.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),o.grid.template.setAll({strokeOpacity:1,stroke:p(i.axisGridStroke)})}function Le(e,n){var l;if(M(e))return;const i=e.data??void 0,t=n.data??void 0;(l=e.chart.get("cursor"))==null||l.set("forceHidden",!(t!=null&&t.refined));const o=i!==t,a=(i==null?void 0:i.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),s=(i==null?void 0:i.uniformScaling)!==(t==null?void 0:t.uniformScaling);e.data=t,e.messages=n.messages,(o||a)&&(Me(e),Pe(e)),s&&V(e),T(e)}function V(e){M(e)||(e.xAxis.zoom(0,1),e.yAxis.zoom(0,1))}function Me(e){const{chart:n,data:i,xAxis:t,yAxis:o}=e,{minX:a,maxX:s,minY:l,maxY:c}=Fe({data:i,pixelWidth:t.width(),pixelHeight:o.height()}),r=!!(i!=null&&i.uniformScaling),d=!!(i!=null&&i.refined);n.setAll({panX:!0,panY:r,pinchZoomX:d,pinchZoomY:d&&r,wheelX:"panX",wheelY:d?r?"zoomXY":"zoomX":"none"}),t.setAll({max:s,min:a,panX:!0,panY:!1,zoomX:!0,zoomY:r}),o.setAll({max:c,min:l,panX:!1,panY:r,zoomX:r,zoomY:r})}function Fe({data:e,pixelWidth:n,pixelHeight:i}){if(e==null)return y;const t=e.statistics,o=0,a=t==null?void 0:t.maxDistance;let s=t==null?void 0:t.minElevation,l=t==null?void 0:t.maxElevation;if(a==null||s==null||l==null)return y;const c=Math.max(a-o,Y);let r=Math.max(l-s,Y);const d=e.effectiveUnits;if(e.dynamicElevationRange){const f=G(c,d.distance,d.elevation);r=Math.max(r,f/v().maxChartRatio)}return s-=Ae*r,l=s+r+he*r,[s,l]=xe(s,l,10),r=l-s,e.uniformScaling?Se({data:e,bounds:{minX:o,maxX:a,minY:s,maxY:l},pixelWidth:n,pixelHeight:i,centered:!0}):{minX:o,maxX:o+c,minY:s,maxY:s+r}}function Se({data:e,bounds:n,pixelWidth:i,pixelHeight:t,centered:o}){if(e==null)return n;let{minX:a,maxX:s,minY:l,maxY:c}=n;if(a==null||s==null||l==null||c==null)return y;const r=s-a,d=c-l,f=e.effectiveUnits,u=G(d,f.elevation,f.distance)/t/(r/i);return u>=1?[a,s]=k([a,s],u):[l,c]=k([l,c],1/u),{minX:a,maxX:s,minY:l,maxY:c}}function k([e,n],i,t){const o=(n-e)*i;{const a=(e+n)/2-o/2;return[a,a+o]}}function Pe(e){var r;const{chart:n,data:i,seriesInfos:t,xAxis:o,yAxis:a}=e;if(i==null||i.lines.length===0)return void n.series.clear();const s=new Map,l=new Set(n.series.values),c=i.lines.length;for(let d=0;d<c;d++){const f=i.lines[d];let u=t.get(f.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=ze(e,f),u.fill&&n.series.push(u.fill),n.series.push(u.line)),s.set(u.id,u);const x=c-d-1;(r=u.fill)==null||r.set("layer",x),u.line.set("layer",c+x),Xe(e,u,f)}e.seriesInfos=s;for(const d of l)n.series.removeValue(d);o.set("layer",c+1),a.set("layer",c+2)}function Xe({theme:e},n,i){const t=p(i.color.toCss()),o=i.samples??[],a=o.length>0,{line:s,fill:l}=n;s.set("visible",a),s.set("stroke",t),l==null||l.set("visible",a),l==null||l.set("fill",pe.lighten(t,e.seriesFillLighten)),s.data.setAll(o),l==null||l.data.setAll(o)}function ze(e,n){const{id:i}=n,t=C(e,`${me}-${i}`);t.setAll({dy:n.chartStrokeOffsetY,tooltip:Ye(e)}),t.strokes.template.setAll({strokeWidth:n.chartStrokeWidth});let o=null;return n.chartFillEnabled&&(o=C(e,`${ge}-${i}`),o.fills.template.setAll({fillOpacity:1,visible:!0})),{id:i,line:t,fill:o}}function C(e,n){return ue.new(e.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:n,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:e.xAxis,yAxis:e.yAxis})}function Ye({theme:e,chart:n}){var a;const i=O.new(n.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),t=e.seriesTooltipPaddingHorizontal,o=e.seriesTooltipPaddingVertical;return i.label.setAll({fill:p(e.seriesTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.seriesTooltipFontSize,paddingBottom:o,paddingLeft:t,paddingRight:t,paddingTop:o,textAlign:"start"}),(a=i.get("background"))==null||a.setAll({stroke:void 0,fill:p(e.seriesTooltipBackgroundColor)}),i.adapters.add("dy",s=>{var r;const l=e.seriesTooltipSpacing,c=((r=i.get("pointTo"))==null?void 0:r.y)??0;return(s??0)+(i.y()>c?l:-l)}),i}function ke(e,n){const{xAxis:i,yAxis:t}=e,o=()=>{n($(i),$(t))},a=s=>[s.on("start",o),s.on("end",o)];return Z([...a(i),...a(t)])}function $(e){const n=Math.abs((e.get("end")??0)-(e.get("start")??0)),i=n!==0?1/n:1;return Math.abs(1-i)<ee()?1:i}function Ce(e,n){const{chart:i,xAxis:t,yAxis:o}=e,a=i.get("cursor"),s=i.plotContainer.events,l=r=>{e.pointerIsOver=r,T(e)},c=()=>{l(!1),n(null,null)};return Z([a==null?void 0:a.events.on("cursormoved",()=>{if(!e.pointerIsOver)return;T(e);let r=(a==null?void 0:a.getPrivate("positionX"))??0,d=(a==null?void 0:a.getPrivate("positionY"))??0;const f=e.data;if((f==null?void 0:f.statistics)!=null){const{maxDistance:u,minElevation:x,maxElevation:F}=f.statistics;u!=null&&(r=w(r,B(t),H(t),0,u)),x!=null&&F!=null&&(d=w(d,B(o),H(o),x,F))}n(r,d)}),s.on("pointerover",()=>l(!0)),s.on("pointerout",c),s.on("blur",c)])}function w(e,n,i,t,o){return(n+e*(i-n)-t)/(o-t)}function T(e){const n=$e(e);if(!n)return void e.seriesInfos.forEach(i=>{var t;(t=i.line.get("tooltip"))==null||t.set("forceHidden",!0)});e.seriesInfos.forEach(i=>{const t=i.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",n)}),e.xAxis.getTooltip().setAll({tooltipText:He(e)})}function $e(e){const{data:n}=e,i=n==null?void 0:n.lines.map(t=>{var o;return{line:t,y:(o=j(e,t))==null?void 0:o.elevation}}).sort(we);return i&&i.length!==0&&i[0].y!=null?i.map(({y:t,line:o})=>Be(e,o,t)).join(`
`):null}function we({y:e},{y:n}){return e==null?1:n==null?-1:n-e}function Be(e,n,i){const{data:t,messages:o}=e;if(t==null||o==null)return"";const a=v().formatPrecision,s=ie(o.chartTooltip,{name:oe(n,o),elevation:i!=null?R(o,i,t.effectiveUnits.elevation,a):ne});return`[${n.color.toHex()}]●[/] ${s}`}function He(e){const{data:n,messages:i}=e;if(n==null||i==null)return"";const t=n.lines[0],o=t?j(e,t):null,a=v().formatPrecision;return o!=null?R(i,o.distance,n.effectiveUnits.distance,a):"-"}function U(e,n){const i=se.new(e.chart.root,{});return i.format=(t,o,a)=>{const{data:s,messages:l}=e;return l==null||s==null||typeof t=="string"?"":`${Q(t,{maximumFractionDigits:a})} ${_(l,s.effectiveUnits[n],"abbr")}`},i}function j({chart:e,xAxis:n},i){const t=i.samples??[];if(t.length===0)return null;const o=e.get("cursor"),a=(o==null?void 0:o.getPrivate("positionX"))??0,s=n.toAxisPosition(a),l=n.positionToValue(s);return te(t,l,c=>c.distance)}function B(e){return e.positionToValue(e.get("start")??0)}function H(e){return e.positionToValue(e.get("end")??1)}function Z(e){return W(e.map(L))}function L(e){return K(()=>{e==null||e.dispose()})}export{Ze as createChart,Fe as getAdjustedBounds};
