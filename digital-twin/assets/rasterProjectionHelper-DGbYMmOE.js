const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/geometryEngine-qkw3BlfJ.js","assets/index--YEV5yv0.js","assets/index-DvOju5Xs.css","assets/geometryEngineBase-B0ZyeKAX.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/hydrated-C5-s-A1n.js"])))=>i.map(i=>d[i]);
import{j as Z,dk as C,dl as I,dm as kn,_ as En,aN as W,dc as Gn,F as hn,cy as Nn,as as G,dn as z,dp as _,dq as N,d4 as _n,ar as Tn,dr as vn,ds as rn,dt as Cn,du as an}from"./index--YEV5yv0.js";var V;function pn(n,t,i){return!Nn(n,t,i)}function O(n,t,i){const o=pn(n,t,i);if(o&&!I())throw new hn("rasterprojectionhelper-project","projection engine is not loaded");return o}(function(n){n[n.None=0]="None",n[n.North=1]="North",n[n.South=2]="South",n[n.Both=3]="Both"})(V||(V={}));const ln=(n,t,i,o=0)=>{if(i[0]===1)return[0,0];let r=1,e=-1,s=1,l=-1;for(let u=0;u<n.length;u+=2)isNaN(n[u])||(r=r>n[u]?n[u]:r,e=e>n[u]?e:n[u],s=s>n[u+1]?n[u+1]:s,l=l>n[u+1]?l:n[u+1]);const{cols:a,rows:f}=t,c=(e-r)/a/i[0],d=(l-s)/f/i[1],p=2*o;let x=0,m=!1,h=[0,0];for(let u=0;u<a-3;u++){for(let R=0;R<f-3;R++){const y=u*f*2+2*R,g=(n[y]+n[y+4]+n[y+4*f]+n[y+4*f+4])/4,w=(n[y+1]+n[y+5]+n[y+4*f+1]+n[y+4*f+5])/4,M=Math.abs((g-n[y+2*f+2])/c),P=Math.abs((w-n[y+2*f+3])/d);if(M+P>x&&(x=M+P,h=[M,P]),p&&x>p){m=!0;break}}if(m)break}return h},On={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},A=32,q=4,X=q,D=new Map,Q=new Map,B=500,zn=39.37,Ln=96;let F=null;async function Xn(){F&&I()||(I()||await kn(),F=await En(()=>import("./geometryEngine-qkw3BlfJ.js"),__vite__mapDeps([0,1,2,3,4,5])))}function $n(n,t,i){return O(n.spatialReference,t),i?an(t,n.spatialReference,n):an(n.spatialReference,t,n)}function Dn(n,t,i,o=null){const r=n.spatialReference;if(!r||!t||r.equals(t))return n;O(r,t,o);const e=i.center,s=new W({xmin:e.x-n.x/2,xmax:e.x+n.x/2,ymin:e.y-n.y/2,ymax:e.y+n.y/2,spatialReference:r}),l=C(s,t,o),a=T(t);return l==null||a!=null&&l.width>=a?j(n,r,t):{x:l.width,y:l.height}}function j(n,t,i){const o=z(t)/z(i);return{x:n.x*o,y:n.y*o}}function Wn(n,t,i){const{spatialReference:o}=i;if(!o||!t||o.equals(t))return n;if(o.isGeographic&&t.isGeographic)return j(n,o,t);if(O(o,t),!F)throw new hn("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:r,y:e}=n;const s=(r+e)/2*z(o);let l=1;s>30&&(l=30/s,r*=l,e*=l);const a=256,f=r*a/2,c=e*a/2,{x:d,y:p}=i.center,x=[];for(let b=0;b<=a;b++)x.push([d-f,p-c+b*e]);for(let b=1;b<=a;b++)x.push([d-f+b*r,p+c]);for(let b=1;b<=a;b++)x.push([d+f,p+c-b*e]);for(let b=1;b<a;b++)x.push([d+f-b*r,p-c]);x.push(x[0]);const m=new Z({rings:[x],spatialReference:o}),h=C(m,t);if(!h)return j(n,o,t);const u=h.extent,R=T(t);if(u==null||R!=null&&u.width>=R)return j(n,o,t);const y=F.planarArea(h),g=r*e*a*a,w=Math.sqrt(y/g)/l,M={x:u.width/l/a,y:u.height/l/a},P={x:r*w,y:e*w},E=M.x*M.y;return Math.abs(E-P.x*P.y)/E<.1?M:P}function jn(n,t){return(typeof n=="number"?n:(n.x+n.y)/2)*z(t)*Ln*zn}function Qn(n,t){const{pixelSize:i,extent:o}=n;return jn(Wn(i,t,o),t)}function k(n,t=.01){return z(n)?t/z(n):0}function fn(n,t,i=null,o=!0){const r=n.spatialReference;if(r.equals(t))return n;O(r,t,i);const e=C(n,t,i);return o&&e&&gn([n],[e],r,t),e}function gn(n,t,i,o){const r=Y(i,!0),e=Y(o,!0),s=k(i,B),l=k(o,B);if(s&&r!=null&&e!=null)for(let a=0;a<n.length;a++){const f=t[a];if(!f)continue;const{x:c}=n[a],{x:d}=f;d>=e[1]-l&&Math.abs(c-r[0])<s?f.x-=e[1]-e[0]:d<=e[0]+l&&Math.abs(c-r[1])<s&&(f.x+=e[1]-e[0])}}function In(n){const{inSR:t,outSR:i,datumTransformation:o,preferPE:r}=n;if(t.equals(i)){const{points:e}=nn(n,null);return e}return t.isWebMercator&&i.isWGS84||t.isWGS84&&i.isWebMercator?qn(n):O(t,i,o)&&r&&(t.isGeographic||L(t)!=null)?cn(n):An(n)}function An(n){const{points:t}=nn(n,null),{inSR:i,outSR:o,datumTransformation:r}=n,e=t.map(l=>new G(l[0],l[1],i)),s=C(e,o,r);return r&&gn(e,s,i,o),s.map(l=>l?[l.x,l.y]:[NaN,NaN])}function cn(n){const{inSR:t,outSR:i,datumTransformation:o}=n,r=L(t),{points:e,mask:s}=nn(n,r);if(!t.isGeographic){const a=t.wkid?_.coordsys(t.wkid):_.fromString(t.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,t.wkt2||t.wkt);rn.projToGeog(a,e.length,e)}if(o!=null&&o.steps.length){let a;if(i.isGeographic&&(a=e.map(([c])=>c>179.9955?1:c<-179.9955?-1:0)),o.steps.forEach(c=>{const d=c.wkid?_.geogtran(c.wkid):_.fromString(N.PE_TYPE_GEOGTRAN,c.wkt);Cn.geogToGeog(d,e.length,e,null,c.isInverse?N.PE_TRANSFORM_2_TO_1:N.PE_TRANSFORM_1_TO_2)}),a)for(let c=0;c<e.length;c++){const d=a[c],p=e[c][0],x=p>179.9955?1:p<-179.9955?-1:0;d&&x&&d!==x&&(e[c][0]=d>0?p+360:p-360)}}if(!i.isGeographic){const a=L(i,!0),f=a!=null&&a.isEnvelope?[a.bbox[1],a.bbox[3]]:[-90,90];Bn(e,f);const c=i.wkid?_.coordsys(i.wkid):_.fromString(i.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,i.wkt2||i.wkt);rn.geogToProj(c,e.length,e)}let l=e;if(s&&e.length!==s.length){l=[];for(let a=0,f=0;a<s.length;a++)s[a]?l.push(e[f++]):l.push([NaN,NaN])}return l}function qn(n){const{cols:t,rows:i,xres:o,yres:r,usePixelCenter:e,inSR:s,outSR:l}=n;let{xmin:a,ymax:f}=n;e&&(a+=o/2,f-=r/2);const c=[],d=[],p=Math.max(t,i);for(let m=0;m<p;m++){const h=a+o*Math.min(t,m),u=f-r*Math.min(i,m),R=C(new G({x:h,y:u,spatialReference:s}),l);m<=t&&c.push(R.x),m<=i&&d.push(R.y)}const x=[];for(let m=0;m<t;m++)for(let h=0;h<i;h++)x.push([c[m],d[h]]);return x}function L(n,t=!1){let i=n.wkid||n.wkt2||n.wkt;if(!i||n.isGeographic)return null;if(i=String(i),D.has(i)){const s=D.get(i);return t?s==null?void 0:s.gcs:s==null?void 0:s.pcs}const o=n.wkid?_.coordsys(n.wkid):_.fromString(n.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,n.wkt2||n.wkt),r=un(o,k(n,1e-4)),e=un(o,0,!0);return D.set(i,{pcs:r,gcs:e}),t?e:r}function un(n,t=0,i=!1){const o=vn.generate(n),r=i?n.horizonGcsGenerate():n.horizonPcsGenerate();if(!o||!(r!=null&&r.length))return null;let e=!1,s=r.find(u=>u.getInclusive()===1&&u.getKind()===1);if(!s){if(s=r.find(u=>u.getInclusive()===1&&u.getKind()===0),!s)return null;e=!0}const l=i?0:(o.getNorthPoleLocation()===2?1:0)|(o.getSouthPoleLocation()===2?2:0),a=o.isPannableRectangle(),f=s.getCoord();if(e)return{isEnvelope:e,isPannable:a,vertices:f,coef:null,bbox:[f[0][0]-t,f[0][1]-t,f[1][0]+t,f[1][1]+t],poleLocation:l};let c=0;const d=[];let[p,x]=f[0],[m,h]=f[0];for(let u=0,R=f.length;u<R;u++){c++,c===R&&(c=0);const[y,g]=f[u],[w,M]=f[c];if(M===g)d.push([y,w,g,M,2]);else{const P=(w-y)/(M-g||1e-4),E=y-P*g;g<M?d.push([P,E,g,M,0]):d.push([P,E,M,g,1])}p=p<y?p:y,x=x<g?x:g,m=m>y?m:y,h=h>g?h:g}return{isEnvelope:!1,isPannable:a,vertices:f,coef:d,bbox:[p,x,m,h],poleLocation:l}}function nn(n,t){const i=[],{cols:o,rows:r,xres:e,yres:s,usePixelCenter:l}=n;let{xmin:a,ymax:f}=n;if(l&&(a+=e/2,f-=s/2),t==null){for(let x=0;x<o;x++)for(let m=0;m<r;m++)i.push([a+e*x,f-s*m]);return{points:i}}const c=new Uint8Array(o*r);if(t.isEnvelope){const{bbox:[x,m,h,u]}=t;for(let R=0,y=0;R<o;R++){const g=a+e*R,w=t.isPannable||g>=x&&g<=h;for(let M=0;M<r;M++,y++){const P=f-s*M;w&&P>=m&&P<=u&&(i.push([g,P]),c[y]=1)}}return{points:i,mask:c}}const d=t.coef,p=[];for(let x=0;x<r;x++){const m=f-s*x,h=[],u=[];for(let y=0;y<d.length;y++){const[g,w,M,P,E]=d[y];if(m===M&&M===P)h.push(g),h.push(w),u.push(2),u.push(2);else if(m>=M&&m<=P){const b=g*m+w;h.push(b),u.push(E)}}let R=h;if(h.length>2){let y=u[0]===2?0:u[0],g=h[0];R=[];for(let w=1;w<u.length;w++)u[w]===2&&w!==u.length-1||(u[w]!==y&&(R.push(y===0?Math.min(g,h[w-1]):Math.max(g,h[w-1])),y=u[w],g=h[w]),w===u.length-1&&R.push(u[w]===0?Math.min(g,h[w]):Math.max(g,h[w])));R.sort((w,M)=>w-M)}else h[0]>h[1]&&(R=[h[1],h[0]]);p.push(R)}for(let x=0,m=0;x<o;x++){const h=a+e*x;for(let u=0;u<r;u++,m++){const R=f-s*u,y=p[u];if(y.length===2)h>=y[0]&&h<=y[1]&&(i.push([h,R]),c[m]=1);else if(y.length>2){let g=!1;for(let w=0;w<y.length;w+=2)if(h>=y[w]&&h<=y[w+1]){g=!0;break}g&&(i.push([h,R]),c[m]=1)}}}return{points:i,mask:c}}function Bn(n,t){const[i,o]=t;for(let r=0;r<n.length;r++){const e=n[r][1];(e<i||e>o)&&(n[r]=[NaN,NaN])}}function yn(n,t){const i=T(n[0].spatialReference);if(n.length<2||i==null||(t=t??k(n[0].spatialReference),(n=n.filter(l=>l.width>t)).length===1))return n[0];let{xmin:o,xmax:r,ymin:e,ymax:s}=n[0];for(let l=1;l<n.length;l++){const a=n[l];r=a.xmax+i*l,e=Math.min(e,a.ymin),s=Math.max(s,a.ymax)}return new W({xmin:o,xmax:r,ymin:e,ymax:s,spatialReference:n[0].spatialReference})}function dn(n,t,i=null,o=!0){const r=n.spatialReference;if(r.equals(t))return n;const e=wn(n),s=T(r,!0),l=T(t);if(e===0||s==null||l==null){const f=H(n,t,i,o);if(s==null&&l!=null&&Math.abs(f.width-l)<k(t)&&I()){const c=L(r);if(c!=null&&c.poleLocation===V.None&&n.width<(c.bbox[2]-c.bbox[0])/2)return Fn(n,t)||f}return f}const a=n.clone().normalize();if(a.length===1&&n.xmax<s&&n.xmax-s/2>k(r)){const{xmin:f,xmax:c}=n;for(let d=0;d<=e;d++){const p=d===0?f:-s/2,x=d===e?c-s*d:s/2;a[d]=new W({xmin:p,xmax:x,ymin:n.ymin,ymax:n.ymax,spatialReference:r})}}return yn(a.map(f=>H(f,t,i,o)).filter(Gn))}function Un(n,t,i){if(n.type==="extent"){const{xmin:o,ymin:r,xmax:e,ymax:s,spatialReference:l}=n;n=new Z({rings:[[[o,s],[e,s],[e,r],[o,r],[o,s]]],spatialReference:l})}return n.spatialReference.equals(t)?n:(O(n.spatialReference,t,i),C(n,t,i))}function Fn(n,t){const i=T(t);if(i==null)return null;let{xmin:o,ymin:r,xmax:e,ymax:s}=n;const l=n.spatialReference,a=new Z({spatialReference:l,rings:[[[o,r],[e,r],[e,s],[o,s],[o,r]]]}),f=C(a,t);if(f.rings.length!==2||!f.rings[0].length||!f.rings[1].length)return null;const{rings:c}=f,d=k(l),p=new W({spatialReference:t});for(let x=0;x<2;x++){o=e=c[x][0][0],r=s=c[x][0][1];for(let m=0;m<c[x].length;m++)o=o>c[x][m][0]?c[x][m][0]:o,e=e<c[x][m][0]?c[x][m][0]:e,r=r>c[x][m][1]?c[x][m][1]:r,s=s<c[x][m][1]?c[x][m][1]:s;if(x===0)p.ymin=r,p.ymax=s,p.xmin=o,p.xmax=e;else if(p.ymin=Math.min(p.ymin,r),p.ymax=Math.max(p.ymax,s),Math.abs(e-i/2)<d)p.xmin=o,p.xmax=p.xmax+i;else{if(!(Math.abs(o+i/2)<d))return null;p.xmax=e+i}}return p}function H(n,t,i=null,o=!0,r=!0){const e=n.spatialReference;if(e.equals(t)||!t)return n;O(e,t,i);const s=C(n,t,i);if(r&&t.isWebMercator&&s&&(s.ymax=Math.min(20037508342787e-6,s.ymax),s.ymin=Math.max(-20037508342787e-6,s.ymin),s.ymin>=s.ymax))return null;if(!o||!s)return s;const l=Y(e,!0),a=Y(t,!0);if(l==null||a==null)return s;const f=k(e,.001),c=k(e,B),d=k(t,.001);if(Math.abs(s.xmin-a[0])<d&&Math.abs(s.xmax-a[1])<d){const p=Math.abs(n.xmin-l[0]),x=Math.abs(l[1]-n.xmax);if(p<f&&x>c){s.xmin=a[0];const m=[];m.push(new G(n.xmax,n.ymin,e)),m.push(new G(n.xmax,(n.ymin+n.ymax)/2,e)),m.push(new G(n.xmax,n.ymax,e));const h=m.map(u=>fn(u,t,i)).filter(u=>!isNaN(u==null?void 0:u.x)).map(u=>u.x);s.xmax=Math.max.apply(null,h)}if(x<f&&p>c){s.xmax=a[1];const m=[];m.push(new G(n.xmin,n.ymin,e)),m.push(new G(n.xmin,(n.ymin+n.ymax)/2,e)),m.push(new G(n.xmin,n.ymax,e));const h=m.map(u=>fn(u,t,i)).filter(u=>!isNaN(u==null?void 0:u.x)).map(u=>u.x);s.xmin=Math.min.apply(null,h)}}else{const p=k(t,.001);Math.abs(s.xmin-a[0])<p&&(s.xmin=a[0]),Math.abs(s.xmax-a[1])<p&&(s.xmax=a[1])}return s}function T(n,t=!1){if(!n)return null;const i=t?20037508342787e-6:20037508342788905e-9;return n.isWebMercator?2*i:n.wkid&&n.isGeographic?360:2*On[n.wkid]||null}function Y(n,t=!1){if(n.isGeographic)return[-180,180];const i=T(n,t);return i!=null?[-i/2,i/2]:null}function xn(n,t,i,o){let r=(n-t)/i;return r-Math.floor(r)!=0?r=Math.floor(r):o&&(r-=1),r}function wn(n,t=!1){const i=T(n.spatialReference);if(i==null)return 0;const o=t?0:-(i/2),r=k(n.spatialReference),e=!t&&Math.abs(n.xmax-i/2)<r?i/2:n.xmax,s=!t&&Math.abs(n.xmin+i/2)<r?-i/2:n.xmin;return xn(e,o,i,!0)-xn(s,o,i,!1)}function Vn(n){const t=n.storageInfo.origin.x,i=T(n.spatialReference,!0);if(i==null)return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const o=i/2,{nativePixelSize:r,storageInfo:e,extent:s}=n,{maximumPyramidLevel:l,blockWidth:a,pyramidScalingFactor:f}=e;let c=r.x;const d=[],p=n.transform!=null&&n.transform.type==="gcs-shift",x=t+(p?0:o),m=p?i-t:o-t;for(let h=0;h<=l;h++){const u=(s.xmax-t)/c/a,R=u-Math.floor(u)==0?u:Math.ceil(u),y=m/c/a,g=y-Math.floor(y)==0?y:Math.ceil(y),w=Math.floor(x/c/a),M=Math.round(x/c)%a,P=(a-Math.round(m/c)%a)%a;d.push({resolutionX:c,blockWidth:a,datasetColumnCount:R,worldColumnCountFromOrigin:g,leftMargin:M,rightPadding:P,originColumnOffset:w}),c*=f}return{originX:t,halfWorldWidth:o,pyramidsInfo:d,hasGCSSShiftTransform:p}}function Yn(n){if(!n||n.isGeographic)return n;const t=String(n.wkid||n.wkt2||n.wkt);let i;return Q.has(t)?i=Q.get(t):(i=(n.wkid?_.coordsys(n.wkid):_.fromString(N.PE_TYPE_PROJCS,n.wkt2||n.wkt)).getGeogcs().getCode(),Q.set(t,i)),new Tn({wkid:i})}function Hn(n){const t=n.isAdaptive&&n.spacing==null;let i=n.spacing||[A,A],o=U(n),r={cols:o.size[0]+1,rows:o.size[1]+1};const e=o.outofBoundPointCount>0&&o.outofBoundPointCount<o.offsets.length/2;let s=o.outofBoundPointCount===o.offsets.length/2||t&&e?[0,0]:ln(o.offsets,r,i,X);const l=(s[0]+s[1])/2,a=n.projectedExtent.spatialReference,f=n.srcBufferExtent.spatialReference;if(t&&(e||l>X)&&(pn(a,f,n.datumTransformation)&&(a.isGeographic||L(a)),i=[q,q],o=U({...n,spacing:i}),r={cols:o.size[0]+1,rows:o.size[1]+1},s=ln(o.offsets,r,i,X)),o.error=s,i[0]>1&&(o.coefficients=mn(o.offsets,r,e)),n.includeGCSGrid&&!a.isGeographic&&!a.isWebMercator)if(f.isGeographic)o.gcsGrid={offsets:o.offsets,coefficients:o.coefficients,spacing:i};else{const c=L(a);if(c!=null&&!c.isEnvelope){const d=Yn(a),p=dn(n.projectedExtent,d),{offsets:x}=U({...n,srcBufferExtent:p,spacing:i}),m=mn(x,r,e);o.gcsGrid={offsets:x,coefficients:m,spacing:i}}}return o}function U(n){const{projectedExtent:t,srcBufferExtent:i,pixelSize:o,datumTransformation:r,rasterTransform:e}=n,s=t.spatialReference,l=i.spatialReference,a=O(s,l),{xmin:f,ymin:c,xmax:d,ymax:p}=t,x=T(l),m=x!=null&&(n.hasWrapAround||(e==null?void 0:e.type)==="gcs-shift"),h=n.spacing||[A,A],u=h[0]*o.x,R=h[1]*o.y,y=h[0]===1,g=Math.ceil((d-f)/u-.1/h[0])+(y?0:1),w=Math.ceil((p-c)/R-.1/h[1])+(y?0:1),M=In({cols:g,rows:w,xmin:f,ymax:p,xres:u,yres:R,inSR:s,outSR:l,datumTransformation:r,preferPE:h[0]<=q,usePixelCenter:y}),P=[];let E,b=0;const tn=y?-1:NaN,{xmin:en,xmax:J,ymax:Mn,width:Rn,height:Pn}=i,bn=k(l,B),Sn=x!=null&&en>0&&J>x/2;let on=!1;if(a){const v=L(s);on=v!=null&&v.poleLocation>0}for(let v=0;v<g;v++){const K=[];for(let $=0;$<w;$++){let S=M[v*w+$];if(m&&S[0]>J&&S[0]>x/2-bn?S[0]-=x:m&&v===0&&S[0]<0&&Sn&&!e&&(S[0]+=x),!S||isNaN(S[0])||isNaN(S[1]))P.push(tn),P.push(tn),K.push(null),b++;else{if(e){const sn=e.inverseTransform(new G({x:S[0],y:S[1],spatialReference:l}));S=[sn.x,sn.y]}K.push(S),v>0&&m&&E[$]&&S[0]<E[$][0]&&(S[0]+=x,on&&S[0]>J&&S[0]>x&&(S[0]-=x)),P.push((S[0]-en)/Rn),P.push((Mn-S[1])/Pn)}}E=K}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:b,spacing:h,size:y?[g,w]:[g-1,w-1]}}function mn(n,t,i){const{cols:o,rows:r}=t,e=new Float32Array((o-1)*(r-1)*2*6),s=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),l=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let a=0;a<o-1;a++){for(let f=0;f<r-1;f++){let c=a*r*2+2*f;const d=n[c],p=n[c+1],x=n[c+2],m=n[c+3];c+=2*r;const h=n[c],u=n[c+1],R=n[c+2],y=n[c+3];let g=0,w=12*(f*(o-1)+a);for(let M=0;M<3;M++)e[w++]=s[g++]*d+s[g++]*x+s[g++]*R;g=0;for(let M=0;M<3;M++)e[w++]=s[g++]*p+s[g++]*m+s[g++]*y;g=0;for(let M=0;M<3;M++)e[w++]=l[g++]*d+l[g++]*h+l[g++]*R;g=0;for(let M=0;M<3;M++)e[w++]=l[g++]*p+l[g++]*u+l[g++]*y}if(i)for(let f=0;f<e.length;f++)isNaN(e[f])&&(e[f]=-1)}return e}function Jn(n,t){const i=n.clone().normalize();return i.length===1?i[0]:yn(i,t)}function Zn(n){const{spatialReference:t}=n,i=_n(t);if(!i)return n;const[o,r]=i.valid,e=r-o;let s=0;if(n.xmin<o){const l=o-n.xmin;s=Math.ceil(l/e)}else if(n.xmin>r){const l=n.xmin-r;s=-Math.ceil(l/e)}return new W({spatialReference:n.spatialReference,xmin:n.xmin+s*e,ymin:n.ymin,xmax:n.xmax+s*e,ymax:n.ymax})}function nt(n,t,i){var m;const{storageInfo:o,pixelSize:r}=t;let e=0,s=!1;const{pyramidResolutions:l}=o,a=((m=o.tileInfo.format)==null?void 0:m.toLowerCase())==="mixed"?Math.max(1,Math.min(3,o.tileInfo.dpi/96)):1,f=(n.x+n.y)/2/a;if(l!=null&&l.length){const h=l[l.length-1],u=(h.x+h.y)/2,R=(r.x+r.y)/2;if(f<=R)e=0;else if(f>=u)e=l.length,s=f/u>8;else{let g,w=R;for(let M=1;M<=l.length;M++){if(g=(l[M-1].x+l[M-1].y)/2,f<=g){f===g?e=M:i==="down"?(e=M-1,s=f/w>8):e=i==="up"||f-w>g-f||f/w>2?M:M-1;break}w=g}}const y=e===0?r:l[e-1];return s&&Math.min(y.x,y.y)*z(t.spatialReference)>19567&&(s=!1),{pyramidLevel:e,pyramidResolution:new G({x:y.x,y:y.y,spatialReference:t.spatialReference}),excessiveReading:s}}const c=Math.log(n.x/r.x)/Math.LN2,d=Math.log(n.y/r.y)/Math.LN2,p=t.storageInfo.maximumPyramidLevel||0;e=i==="down"?Math.floor(Math.min(c,d)):i==="up"?Math.ceil(Math.max(c,d)):Math.round((c+d)/2),e<0?e=0:e>p&&(s=e>p+3,e=p);const x=2**e;return{pyramidLevel:e,pyramidResolution:new G({x:x*t.nativePixelSize.x,y:x*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:s}}function tt(n,t,i=!1){const{pixelSize:o,extent:r}=n,e=$n(r,t,!1),s=dn(Jn(r,(o.x+o.y)/16),t,e);return i||wn(s)===0?s:H(r,t,e)}export{fn as B,Qn as O,dn as V,Un as Z,$n as _,Hn as a,Xn as j,nt as m,wn as o,Vn as r,T as t,Zn as u,pn as w,tt as x,Dn as z};
