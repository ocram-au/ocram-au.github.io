import{o as F,l as Z}from"./ResponsiveTheme-CGYj4mXI.js";import{o as N,it as Q,iu as q,iv as D,d3 as P,hQ as G,iw as v,a8 as J,ix as K,iy as _,iz as R,iA as ee,iB as te,iC as ie,iD as ne,iE as oe}from"./index-Bmji7YKu.js";import{G as ae,D as se}from"./chartUtilsAm5-CO9HNdft.js";import{n as le,g as z,b as re,x as de,l as ce,f as ue}from"./LineSeries-Cr7RccI9.js";import{z as x,a3 as b,r as fe,Y as pe}from"./Theme-CyFq2Q2h.js";import{u as O}from"./Tooltip-Cni9M6wO.js";import"./DefaultTheme-BjDXXwb9.js";import"./ColorSet-D_iGA5jJ.js";import"./Tick-BpFUfYgg.js";import"./Button-DanbJ7NA.js";function xe(e,n,i=10){const t=Y(n-e,!1);if(t===0)return[e,n];const o=Y(t/(i-1),!0);return[Math.floor(e/o)*o,Math.ceil(n/o)*o]}function Y(e,n){const i=Math.floor(Math.log10(e)),t=e/10**i;let o;return o=n?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,o*10**i}const A="#f8f8f8",W="#a9a9a9",g="#323232",me="line",ge="fill",h=15,m=12,X=.001,he=.1,Ae=.02,E={fontFamily:"Avenir Next",paddingBottom:m/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:W,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(m/4),axisTooltipPaddingBottom:Math.round(m/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(m/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:m/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},ve={...E,axisGridStroke:g,axisLabelsColor:W,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Ze(e){const n=await ae(e.container);N(e.abortOptions);const i=Q(),t=i?ve:E;n.setThemes(i?[F.new(n),Z.new(n)]:[F.new(n)]);const o=q(e.container),a=n.container.children.push(le.new(n,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:o?t.paddingRight:t.paddingLeft,paddingRight:o?t.paddingLeft:t.paddingRight,maxTooltipDistance:-1}));a.zoomOutButton.set("forceHidden",!0);const s=a.xAxes.push(z.new(n,{renderer:re.new(n,{})})),l=a.yAxes.push(z.new(n,{renderer:de.new(n,{})})),c=P(null),d=P("loading"),r={chart:a,xAxis:s,yAxis:l,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,rtl:o,get state(){return d.value},get data(){return c.value},set data(p){c.value=p}};ye(r),Te(r),be(r);const f=D([Ce(r,e.onRangeChange),ke(r,e.onCursorPositionChange),M(n.events.once("frameended",()=>{d.value="ready"})),M(n)]);return{destroy:()=>{f.remove(),d.value="destroyed"},update:p=>{p.data===r.data&&p.messages===r.messages||L(r)||Me(r,p)},zoomOut:()=>I(r),test:void 0}}function L(e){return e.state==="destroyed"}function be({chart:e,xAxis:n,yAxis:i}){const t=ce.new(e.root,{behavior:"none",xAxis:n,yAxis:i,snapToSeriesBy:"y"});t.lineY.set("visible",!1),e.set("cursor",t)}function ye(e){var s;const{chart:n,xAxis:i,theme:t}=e;i.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:V(e,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),i.axisHeader.set("forceHidden",!0);const o=i.get("renderer");o.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),o.labels.template.setAll({centerX:b,centerY:b,fill:x(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const a=i.set("tooltip",O.new(n.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(s=a.get("background"))==null||s.setAll({fill:x(t.axisTooltipBackgroundColor),stroke:void 0}),a.label.setAll({fill:x(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop,direction:e.rtl?"rtl":"ltr"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(t.axisGridStroke)})}function Te(e){const{yAxis:n,theme:i,rtl:t}=e;n.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:V(e,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),n.axisHeader.set("visible",!1);const o=n.get("renderer");o.setAll({minGridDistance:i.yAxisMinGridDistance,opposite:t,inside:!0}),o.labels.template.setAll({centerX:b,centerY:fe,fill:x(i.axisLabelsColor),fontFamily:i.fontFamily,fontSize:i.axisLabelsFontSize,fontWeight:i.axisLabelsFontWeight,maxPosition:i.yAxisMaxLabelPosition,minPosition:i.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:i.yAxisLabelSpacing,paddingRight:t?i.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(i.axisGridStroke)})}function Me(e,n){var l;if(L(e))return;const i=e.data??void 0,t=n.data??void 0;(l=e.chart.get("cursor"))==null||l.set("forceHidden",!(t!=null&&t.refined));const o=i!==t,a=(i==null?void 0:i.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),s=(i==null?void 0:i.uniformScaling)!==(t==null?void 0:t.uniformScaling);e.data=t,e.messages=n.messages,(o||a)&&(Le(e),Pe(e)),s&&I(e),T(e)}function I(e){L(e)||(e.xAxis.zoom(0,1),e.yAxis.zoom(0,1))}function Le(e){const{chart:n,data:i,xAxis:t,yAxis:o}=e,{minX:a,maxX:s,minY:l,maxY:c}=Se({data:i,pixelWidth:t.width(),pixelHeight:o.height()}),d=!!(i!=null&&i.uniformScaling),r=!!(i!=null&&i.refined);n.setAll({panX:!0,panY:d,pinchZoomX:r,pinchZoomY:r&&d,wheelX:"panX",wheelY:r?d?"zoomXY":"zoomX":"none"}),t.setAll({max:s,min:a,panX:!0,panY:!1,zoomX:!0,zoomY:d}),o.setAll({max:c,min:l,panX:!1,panY:d,zoomX:d,zoomY:d})}function Se({data:e,pixelWidth:n,pixelHeight:i}){if(e==null)return y;const t=e.statistics,o=0,a=t==null?void 0:t.maxDistance;let s=t==null?void 0:t.minElevation,l=t==null?void 0:t.maxElevation;if(a==null||s==null||l==null)return y;const c=Math.max(a-o,X);let d=Math.max(l-s,X);const r=e.effectiveUnits;if(e.dynamicElevationRange){const f=G(c,r.distance,r.elevation);d=Math.max(d,f/v().maxChartRatio)}return s-=Ae*d,l=s+d+he*d,[s,l]=xe(s,l,10),d=l-s,e.uniformScaling?Fe({data:e,bounds:{minX:o,maxX:a,minY:s,maxY:l},pixelWidth:n,pixelHeight:i,centered:!0}):{minX:o,maxX:o+c,minY:s,maxY:s+d}}function Fe({data:e,bounds:n,pixelWidth:i,pixelHeight:t,centered:o}){if(e==null)return n;let{minX:a,maxX:s,minY:l,maxY:c}=n;if(a==null||s==null||l==null||c==null)return y;const d=s-a,r=c-l,f=e.effectiveUnits,u=G(r,f.elevation,f.distance)/t/(d/i);return u>=1?[a,s]=C([a,s],u):[l,c]=C([l,c],1/u),{minX:a,maxX:s,minY:l,maxY:c}}function C([e,n],i,t){const o=(n-e)*i;{const a=(e+n)/2-o/2;return[a,a+o]}}function Pe(e){var d;const{chart:n,data:i,seriesInfos:t,xAxis:o,yAxis:a}=e;if(i==null||i.lines.length===0)return void n.series.clear();const s=new Map,l=new Set(n.series.values),c=i.lines.length;for(let r=0;r<c;r++){const f=i.lines[r];let u=t.get(f.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=Ye(e,f),u.fill&&n.series.push(u.fill),n.series.push(u.line)),s.set(u.id,u);const p=c-r-1;(d=u.fill)==null||d.set("layer",p),u.line.set("layer",c+p),ze(e,u,f)}e.seriesInfos=s;for(const r of l)n.series.removeValue(r);o.set("layer",c+1),a.set("layer",c+2)}function ze({theme:e},n,i){const t=x(i.color.toCss()),o=i.samples??[],a=o.length>0,{line:s,fill:l}=n;s.set("visible",a),s.set("stroke",t),l==null||l.set("visible",a),l==null||l.set("fill",pe.lighten(t,e.seriesFillLighten)),s.data.setAll(o),l==null||l.data.setAll(o)}function Ye(e,n){const{id:i}=n,t=k(e,`${me}-${i}`),o=Xe(e);t.setAll({dy:n.chartStrokeOffsetY,tooltip:o}),t.strokes.template.setAll({strokeWidth:n.chartStrokeWidth});let a=null;return n.chartFillEnabled&&(a=k(e,`${ge}-${i}`),a.fills.template.setAll({fillOpacity:1,visible:!0})),{id:i,line:t,fill:a}}function k(e,n){return ue.new(e.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:n,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:e.xAxis,yAxis:e.yAxis})}function Xe({theme:e,chart:n,rtl:i}){var s;const t=O.new(n.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),o=e.seriesTooltipPaddingHorizontal,a=e.seriesTooltipPaddingVertical;return t.label.setAll({fill:x(e.seriesTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.seriesTooltipFontSize,paddingBottom:a,paddingLeft:o,paddingRight:o,paddingTop:a,textAlign:i?"end":"start",direction:"ltr"}),(s=t.get("background"))==null||s.setAll({stroke:void 0,fill:x(e.seriesTooltipBackgroundColor)}),t.adapters.add("dy",l=>{var r;const c=e.seriesTooltipSpacing,d=((r=t.get("pointTo"))==null?void 0:r.y)??0;return(l??0)+(t.y()>d?c:-c)}),t}function Ce(e,n){const{xAxis:i,yAxis:t}=e,o=()=>{n(w(i),w(t))},a=s=>[s.on("start",o),s.on("end",o)];return j([...a(i),...a(t)])}function w(e){const n=Math.abs((e.get("end")??0)-(e.get("start")??0)),i=n!==0?1/n:1;return Math.abs(1-i)<ee()?1:i}function ke(e,n){const{chart:i,xAxis:t,yAxis:o}=e,a=i.get("cursor"),s=i.plotContainer.events,l=d=>{e.pointerIsOver=d,T(e)},c=()=>{l(!1),n(null,null)};return j([a==null?void 0:a.events.on("cursormoved",()=>{if(!e.pointerIsOver)return;T(e);let d=(a==null?void 0:a.getPrivate("positionX"))??0,r=(a==null?void 0:a.getPrivate("positionY"))??0;const f=e.data;if((f==null?void 0:f.statistics)!=null){const{maxDistance:u,minElevation:p,maxElevation:S}=f.statistics;u!=null&&(d=$(d,B(t),H(t),0,u)),p!=null&&S!=null&&(r=$(r,B(o),H(o),p,S))}n(d,r)}),s.on("pointerover",()=>l(!0)),s.on("pointerout",c),s.on("blur",c)])}function $(e,n,i,t,o){return(n+e*(i-n)-t)/(o-t)}function T(e){const n=we(e);if(!n)return void e.seriesInfos.forEach(i=>{var t;(t=i.line.get("tooltip"))==null||t.set("forceHidden",!0)});e.seriesInfos.forEach(i=>{const t=i.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",n)}),e.xAxis.getTooltip().setAll({tooltipText:He(e)})}function we(e){const{data:n}=e,i=n==null?void 0:n.lines.map(t=>{var o;return{line:t,y:(o=U(e,t))==null?void 0:o.elevation}}).sort($e);return i&&i.length!==0&&i[0].y!=null?i.map(({y:t,line:o})=>Be(e,o,t)).join(`
`):null}function $e({y:e},{y:n}){return e==null?1:n==null?-1:n-e}function Be(e,n,i){const{data:t,messages:o}=e;if(t==null||o==null)return"";const a=`[${n.color.toHex()}]●[/]`,s="  ",l=v().formatPrecision,c=ie(o.chartTooltip,{name:oe(n,o),elevation:i!=null?R(o,i,t.effectiveUnits.elevation,l):ne});return e.rtl?c+s+a:a+s+c}function He(e){const{data:n,messages:i}=e;if(n==null||i==null)return"";const t=n.lines[0],o=t?U(e,t):null,a=v().formatPrecision;return o!=null?R(i,o.distance,n.effectiveUnits.distance,a):"-"}function V(e,n){const i=se.new(e.chart.root,{});return i.format=(t,o,a)=>{const{data:s,messages:l}=e;return l==null||s==null||typeof t=="string"?"":`${K(t,{maximumFractionDigits:a})} ${_(l,s.effectiveUnits[n],"abbr")}`},i}function U({chart:e,xAxis:n},i){const t=i.samples??[];if(t.length===0)return null;const o=e.get("cursor"),a=(o==null?void 0:o.getPrivate("positionX"))??0,s=n.toAxisPosition(a),l=n.positionToValue(s);return te(t,l,c=>c.distance)}function B(e){return e.positionToValue(e.get("start")??0)}function H(e){return e.positionToValue(e.get("end")??1)}function j(e){return D(e.map(M))}function M(e){return J(()=>{e==null||e.dispose()})}export{Ze as createChart,Se as getAdjustedBounds};
