import{af as E,aO as m,aP as S,aQ as $,aR as R,aS as D,aT as b,al as i,aU as N,aV as P,aW as y,aX as g,aY as U,aZ as F,a_ as H,a$ as G,aJ as T,b0 as w,b1 as h,b2 as A,b3 as I,aF as O,b4 as k,aK as _,aM as q,aH as J,b5 as K}from"./index-muoB0VoA.js";import{w as j}from"./InteractiveToolBase-DkGA8phF.js";function z(n,r){return C(n,()=>r)}function L(n){return C(n,r=>r.plane)}function C(n,r){const t=i(),a=i();let l=!1;return e=>{const o=r(e);if(e.action==="start"){const c=m(e.screenStart,S($.get())),u=R(n.state.camera,c,x);u!=null&&(l=b(o,u,t))}if(!l)return null;const s=m(e.screenEnd,S($.get())),d=R(n.state.camera,s,x);return d==null?null:b(o,d,a)?{...e,renderStart:t,renderEnd:a,plane:o,ray:d}:null}}function B(n,r,t=0,a=null,l=null){let e=null;return o=>{if(o.action==="start"&&(e=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenStart.x,o.screenStart.y),r,t,l),e!=null&&a!=null&&!H(e,e,a))||e==null)return null;const s=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenEnd.x,o.screenEnd.y),r,t,l);return s!=null&&(a==null||H(s,s,a))?{...o,mapStart:e,mapEnd:s}:null}}function Q(n,r,t,a=null,l=null){return B(n,t,F(r,n,t),a,l)}function nn(n,r,t,a){const l=t.toMap(n.screenStart);return l!=null?Q(r,l,t.elevationInfo,a):null}function V(n,r){const t=M,a=v,l=G();n.renderCoordsHelper.worldUpAtPosition(r,t);const e=T(h(l),t,w(a,r,n.state.camera.eye));return T(e,e,t),A(r,e,l)}function en(n,r,t){let a=null;const l=new j;return l.next(z(n,V(n,r))).next(W(n,r)).next(X(n,t)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,a=e}),e=>(a=null,l.execute(e),a)}function W(n,r){const t=i(),a=I(r);n.renderCoordsHelper.worldUpAtPosition(r,t);const l=i(),e=i(),o=s=>(w(s,s,r),k(t,s,s),n.viewingMode==="global"&&I(s)*Math.sign(_(t,s))<.001-a&&w(s,q(s,t,.001),r),J(s,s,r),s);return s=>(s.renderStart=o(O(l,s.renderStart)),s.renderEnd=o(O(e,s.renderEnd)),s)}function tn(n,r){const t=a=>{const l=m(a,S($.get())),e=R(n.state.camera,l,x);return e==null?null:K(r,e,M,v)[1]};return a=>{const l=t(a.screenStart);if(l==null)return null;const e=t(a.screenEnd);return e==null?null:{...a,renderStart:l,renderEnd:e}}}function X(n,r){const t=n.renderCoordsHelper;return a=>{const l=t.fromRenderCoords(a.renderStart,new E({spatialReference:r})),e=t.fromRenderCoords(a.renderEnd,new E({spatialReference:r}));return l!=null&&e!=null?{...a,mapStart:l,mapEnd:e}:null}}var f;function rn(n){let r=null;return t=>{switch(t.action){case"start":r=n.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function an(n,r=null){const t=N(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=P.MIN,t.options.hud=!1;const a=g(),l={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},e=i(),o=r??n.spatialReference,s=c=>{n.map.ground&&n.map.ground.opacity<1?l.exclude.add(y):l.exclude.delete(y),n.sceneIntersectionHelper.intersectIntersectorScreen(m(c,a),t,l);const u=t.results.min;let p;if(u.getIntersectionPoint(e))p=u.intersector===U.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(e))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(e,new E({spatialReference:o})),surfaceType:p}};let d;return c=>{if(c.action==="start"){const p=s(c.screenStart);d=p!=null?p.location:null}if(d==null)return null;const u=s(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const M=i(),v=i(),x=D();export{X as A,L as C,Q as D,f as F,en as G,nn as M,z as O,tn as k,rn as q,an as z};
