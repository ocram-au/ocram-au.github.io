import{dk as N,dl as m,dm as E,dn as S,dp as $,dq as y,ar as R,bk as d,dr as b,ds as H,dt as C,di as F,dj as G,du as g,dv as I,dw as P,cZ as T,c8 as x,dx as U,dy as h,dz as k,dA as A,dB as q,dC as j,dD as z,dE as v,dF as B}from"./index-ByUZEoNK.js";import{w as _}from"./ShadedColorMaterial.glsl-CHi8IP3d.js";function J(n,r){return D(n,()=>r)}function Y(n){return D(n,r=>r.plane)}function D(n,r){const t=d(),l=d();let s=!1;return e=>{const o=r(e);if(e.action==="start"){const c=m(e.screenStart,E(S.get())),u=$(n.state.camera,c,w);u!=null&&(s=y(o,u,t))}if(!s)return null;const a=m(e.screenEnd,E(S.get())),i=$(n.state.camera,a,w);return i==null?null:y(o,i,l)?{...e,renderStart:t,renderEnd:l,plane:o,ray:i}:null}}function K(n,r,t=0,l=null,s=null){let e=null;return o=>{if(o.action==="start"&&(e=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenStart.x,o.screenStart.y),r,t,s),e!=null&&l!=null&&!I(e,e,l))||e==null)return null;const a=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenEnd.x,o.screenEnd.y),r,t,s);return a!=null&&(l==null||I(a,a,l))?{...o,mapStart:e,mapEnd:a}:null}}function Z(n,r,t,l=null,s=null){return K(n,t,b(r,n,t),l,s)}function nn(n,r,t,l){const s=t.toMap(n.screenStart);return s!=null?Z(r,s,t.elevationInfo,l):null}function L(n,r){const t=O,l=M,s=P();n.renderCoordsHelper.worldUpAtPosition(r,t);const e=T(U(s),t,x(l,r,n.state.camera.eye));return T(e,e,t),h(r,e,s)}function en(n,r,t){let l=null;const s=new _;return s.next(J(n,L(n,r))).next(Q(n,r)).next(V(n,t)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,l=e}),e=>(l=null,s.execute(e),l)}function Q(n,r){const t=d(),l=H(r);n.renderCoordsHelper.worldUpAtPosition(r,t);const s=d(),e=d(),o=a=>(x(a,a,r),k(t,a,a),n.viewingMode==="global"&&H(a)*Math.sign(A(t,a))<.001-l&&x(a,q(a,t,.001),r),j(a,a,r),a);return a=>(a.renderStart=o(C(s,a.renderStart)),a.renderEnd=o(C(e,a.renderEnd)),a)}function tn(n,r){const t=l=>{const s=m(l,E(S.get())),e=$(n.state.camera,s,w);return e==null?null:z(r,e,O,M)[1]};return l=>{const s=t(l.screenStart);if(s==null)return null;const e=t(l.screenEnd);return e==null?null:{...l,renderStart:s,renderEnd:e}}}function V(n,r){const t=n.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new R({spatialReference:r})),e=t.fromRenderCoords(l.renderEnd,new R({spatialReference:r}));return s!=null&&e!=null?{...l,mapStart:s,mapEnd:e}:null}}var f;function rn(n){let r=null;return t=>{switch(t.action){case"start":r=n.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function ln(n,r=null){const t=F(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=G.MIN,t.options.hud=!1;const l=g(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},e=d(),o=r??n.spatialReference,a=c=>{n.map.ground&&n.map.ground.opacity<1?s.exclude.add(v):s.exclude.delete(v),n.sceneIntersectionHelper.intersectIntersectorScreen(m(c,l),t,s);const u=t.results.min;let p;if(u.getIntersectionPoint(e))p=u.intersector===B.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(e))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(e,new R({spatialReference:o})),surfaceType:p}};let i;return c=>{if(c.action==="start"){const p=a(c.screenStart);i=p!=null?p.location:null}if(i==null)return null;const u=a(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:i,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const O=d(),M=d(),w=N();export{V as A,Y as C,Z as D,en as G,nn as M,J as O,tn as k,rn as q,ln as z};
