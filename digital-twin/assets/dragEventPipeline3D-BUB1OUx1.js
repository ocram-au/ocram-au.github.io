import{aO as D,aP as m,aQ as E,aR as S,aS as $,aT as b,af as R,as as i,aU as G,aV as y,aK as H,aW as g,aX as T,aY as N,aM as I,aZ as x,a_ as P,a$ as U,b0 as F,aJ as h,aG as A,aF as k,b1 as _,b2 as q,b3 as J,b4 as O,b5 as K}from"./index-CL06UQdw.js";import{w as j}from"./InteractiveToolBase-CS2PMy6l.js";function z(n,r){return C(n,()=>r)}function L(n){return C(n,r=>r.plane)}function C(n,r){const t=i(),a=i();let l=!1;return e=>{const o=r(e);if(e.action==="start"){const c=m(e.screenStart,E(S.get())),u=$(n.state.camera,c,w);u!=null&&(l=b(o,u,t))}if(!l)return null;const s=m(e.screenEnd,E(S.get())),d=$(n.state.camera,s,w);return d==null?null:b(o,d,a)?{...e,renderStart:t,renderEnd:a,plane:o,ray:d}:null}}function B(n,r,t=0,a=null,l=null){let e=null;return o=>{if(o.action==="start"&&(e=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenStart.x,o.screenStart.y),r,t,l),e!=null&&a!=null&&!T(e,e,a))||e==null)return null;const s=n.sceneIntersectionHelper.intersectElevationFromScreen(g(o.screenEnd.x,o.screenEnd.y),r,t,l);return s!=null&&(a==null||T(s,s,a))?{...o,mapStart:e,mapEnd:s}:null}}function Q(n,r,t,a=null,l=null){return B(n,t,G(r,n,t),a,l)}function nn(n,r,t,a){const l=t.toMap(n.screenStart);return l!=null?Q(r,l,t.elevationInfo,a):null}function V(n,r){const t=M,a=v,l=N();n.renderCoordsHelper.worldUpAtPosition(r,t);const e=I(P(l),t,x(a,r,n.state.camera.eye));return I(e,e,t),U(r,e,l)}function en(n,r,t){let a=null;const l=new j;return l.next(z(n,V(n,r))).next(W(n,r)).next(X(n,t)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,a=e}),e=>(a=null,l.execute(e),a)}function W(n,r){const t=i(),a=y(r);n.renderCoordsHelper.worldUpAtPosition(r,t);const l=i(),e=i(),o=s=>(x(s,s,r),F(t,s,s),n.viewingMode==="global"&&y(s)*Math.sign(h(t,s))<.001-a&&x(s,A(s,t,.001),r),k(s,s,r),s);return s=>(s.renderStart=o(H(l,s.renderStart)),s.renderEnd=o(H(e,s.renderEnd)),s)}function tn(n,r){const t=a=>{const l=m(a,E(S.get())),e=$(n.state.camera,l,w);return e==null?null:J(r,e,M,v)[1]};return a=>{const l=t(a.screenStart);if(l==null)return null;const e=t(a.screenEnd);return e==null?null:{...a,renderStart:l,renderEnd:e}}}function X(n,r){const t=n.renderCoordsHelper;return a=>{const l=t.fromRenderCoords(a.renderStart,new R({spatialReference:r})),e=t.fromRenderCoords(a.renderEnd,new R({spatialReference:r}));return l!=null&&e!=null?{...a,mapStart:l,mapEnd:e}:null}}var f;function rn(n){let r=null;return t=>{switch(t.action){case"start":r=n.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function an(n,r=null){const t=_(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=q.MIN,t.options.hud=!1;const a=g(),l={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},e=i(),o=r??n.spatialReference,s=c=>{n.map.ground&&n.map.ground.opacity<1?l.exclude.add(O):l.exclude.delete(O),n.sceneIntersectionHelper.intersectIntersectorScreen(m(c,a),t,l);const u=t.results.min;let p;if(u.getIntersectionPoint(e))p=u.intersector===K.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(e))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(e,new R({spatialReference:o})),surfaceType:p}};let d;return c=>{if(c.action==="start"){const p=s(c.screenStart);d=p!=null?p.location:null}if(d==null)return null;const u=s(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const M=i(),v=i(),w=D();export{X as A,L as C,Q as D,f as F,en as G,nn as M,z as O,tn as k,rn as q,an as z};
